<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        body {
            font-family: Helvetica, sans-serif;
        }

        .play-area {
            box-sizing: border-box;
            width: 100%;
            padding: 2%;
            display: flex;
            flex-direction: row;
            margin-top: 5%;
            border: 2px solid black;
            border-radius: 10px;
            align-items: center;
            justify-content: space-between;
        }

        .hole {
            border: 2px solid black;
            border-radius: 50%;
            width: 8%;
            aspect-ratio: 1 / 1;
        }

        .empty-hole {
            background: grey;
        }

        .green-hole {
            background: darkgreen;
        }

        .yellow-hole {
            background: yellow;
        }
    </style>
    <title>Switch 5</title>
</head>

<body>
    <h1>Switch 5</h1>
    <p>
        Move all the green disks to the right and all the yellow disks to the left.
        There are two rules:
    </p>
    <ol>
        <li>
            Green disks can only move to the right and yellow disks can only
            move to the left.
        </li>
        <li>
            A disk can jump over a single other disk if there is a space on the
            other side.
        </li>
    </ol>
    <p>Click a disk to move it.</p>
    <div>
        <button onclick="ctrl_Reset()">Reset</button>
    </div>
    <div class="play-area">
        <div id="hole0" class="hole green-hole"></div>
        <div id="hole1" class="hole green-hole"></div>
        <div id="hole2" class="hole green-hole"></div>
        <div id="hole3" class="hole green-hole"></div>
        <div id="hole4" class="hole green-hole"></div>
        <div id="hole5" class="hole empty-hole"></div>
        <div id="hole6" class="hole yellow-hole"></div>
        <div id="hole7" class="hole yellow-hole"></div>
        <div id="hole8" class="hole yellow-hole"></div>
        <div id="hole9" class="hole yellow-hole"></div>
        <div id="hole10" class="hole yellow-hole"></div>
    </div>
    <script>
        /* -------------------- VIEW -------------------- */
        function view_GetHole(n) {
            return document.getElementById(`hole${n}`);
        }

        function view_Reset() {
            for (let i = 0; i < 5; i++) {
                view_GetHole(i).className = "hole green-hole";
            }

            view_GetHole(5).className = "hole empty-hole";

            for (let i = 6; i < 11; i++) {
                view_GetHole(i).className = "hole yellow-hole";
            }
        }


        function view_Swap(m, n) {
            const hole1 = view_GetHole(m);
            const hole2 = view_GetHole(n);

            const hole1Class = hole1.className;
            hole1.className = hole2.className;
            hole2.className = hole1Class;
        }

        /* -------------------- MODEL -------------------- */
        let holes = [
            "green",
            "green",
            "green",
            "green",
            "green",
            "empty",
            "yellow",
            "yellow",
            "yellow",
            "yellow",
            "yellow"
        ];

        function model_Swap(m, n) {
            const temp = holes[m];
            holes[m] = holes[n];
            holes[n] = temp;
        }

        /* -------------------- CONTROLLER -------------------- */
        function ctrl_Reset() {
            holes = [
                "green",
                "green",
                "green",
                "green",
                "green",
                "empty",
                "yellow",
                "yellow",
                "yellow",
                "yellow",
                "yellow"
            ];

            view_Reset();
        }

        function ctrl_Click(holeNumber) {
            if (holeNumber < 0 || holeNumber > 10) {
                return;
            }
            const colour = holes[holeNumber];
            if (colour === "green") {
                const canAdvanceByOne = holeNumber <= 9
                    && holes[holeNumber + 1] === "empty";
                if (canAdvanceByOne) {
                    model_Swap(holeNumber, holeNumber + 1);
                    view_Swap(holeNumber, holeNumber + 1);
                    return;
                }

                const canAdvanceByTwo = holeNumber <= 8 && holes[holeNumber + 2] === "empty";
                if (canAdvanceByTwo) {
                    model_Swap(holeNumber, holeNumber + 2);
                    view_Swap(holeNumber, holeNumber + 2);
                    return;
                }
            }
            else if (colour === "yellow") {
                const canAdvanceByOne = holeNumber >= 1
                    && holes[holeNumber - 1] === "empty";
                if (canAdvanceByOne) {
                    model_Swap(holeNumber, holeNumber - 1);
                    view_Swap(holeNumber, holeNumber - 1);
                    return;
                }

                const canAdvanceByTwo = holeNumber >= 2 && holes[holeNumber - 2] === "empty";
                if (canAdvanceByTwo) {
                    model_Swap(holeNumber, holeNumber - 2);
                    view_Swap(holeNumber, holeNumber - 2);
                    return;
                }
            }
        }

        function ctrl_Solve(holeNumber) {
            // TODO
        }

        /* -------------------- START -------------------- */
        (() => {
            for (let i = 0; i < 11; i++) {
                view_GetHole(i).addEventListener("click", () => ctrl_Click(i));
            }

            ctrl_Reset();
        })();
    </script>
</body>

</html>